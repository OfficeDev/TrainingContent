/* Outlook specific API library */
/* Version: 15.0.4420.1017 Build Time: 03/31/2014 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

Type.registerNamespace("Microsoft.Office.WebExtension.MailboxEnums");Microsoft.Office.WebExtension.MailboxEnums.EntityType={MeetingSuggestion:"meetingSuggestion",TaskSuggestion:"taskSuggestion",Address:"address",EmailAddress:"emailAddress",Url:"url",PhoneNumber:"phoneNumber",Contact:"contact"};Microsoft.Office.WebExtension.MailboxEnums.ItemType={Message:"message",Appointment:"appointment"};Microsoft.Office.WebExtension.MailboxEnums.ResponseType={None:"none",Organizer:"organizer",Tentative:"tentative",Accepted:"accepted",Declined:"declined"};Microsoft.Office.WebExtension.MailboxEnums.RecipientType={Other:"other",DistributionList:"distributionList",User:"user",ExternalUser:"externalUser"};Microsoft.Office.WebExtension.MailboxEnums.AttachmentType={File:"file",Item:"item"}

Type.registerNamespace("OSF.DDA");OSF.DDA.OutlookAppOm=function(n,t,i){this.$$d_$1w_0=Function.createDelegate(this,this.$1w_0);this.$$d_$2Z_0=Function.createDelegate(this,this.$2Z_0);this.$$d_$2X_0=Function.createDelegate(this,this.$2X_0);this.$$d_$31_0=Function.createDelegate(this,this.$31_0);this.$$d_$2h_0=Function.createDelegate(this,this.$2h_0);this.$$d_$2e_0=Function.createDelegate(this,this.$2e_0);OSF.DDA.OutlookAppOm.$4=this;this.$L_0=n;this.$18_0=i;var u=this;var r=function(){i&&u.$7_0(1,"GetInitialData",null,u.$$d_$2e_0)};this.$19_0()?r():this.$36_0(r)};OSF.DDA.OutlookAppOm.$9=function(n,t,i,r){var f={};f[OSF.DDA.AsyncResultEnum.Properties.Value]=n;f[OSF.DDA.AsyncResultEnum.Properties.Context]=r;var u=null;if(0!==t){u={};u[OSF.DDA.AsyncResultEnum.ErrorProperties.Name]=t;u[OSF.DDA.AsyncResultEnum.ErrorProperties.Message]=i}return new OSF.DDA.AsyncResult(f,u)};OSF.DDA.OutlookAppOm.$D=function(n){if(!n)throw Error.create(_u.ExtensibilityStrings.l_ElevatedPermissionNeeded_Text);};OSF.DDA.OutlookAppOm.$C=function(n,t,i){if(n<t)throw Error.create(String.format(_u.ExtensibilityStrings.l_ElevatedPermissionNeededForMethod_Text,i));};OSF.DDA.OutlookAppOm.$H=function(n,t,i){if(Object.getType(n)!==t)throw Error.argumentType(i);};OSF.DDA.OutlookAppOm.$T=function(n,t,i,r){if(n<t||n>i)throw Error.argumentOutOfRange(r);};OSF.DDA.OutlookAppOm.$17=function(n,t,i,r){if(!$h.ScriptHelpers.isNullOrUndefined(n)){OSF.DDA.OutlookAppOm.$H(n,String,r);var u=n;OSF.DDA.OutlookAppOm.$T(u.length,t,i,r)}};OSF.DDA.OutlookAppOm.$21=function(n,t){var i=null;switch(n){case 1:case 2:case 12:case 3:break;case 4:var r=JSON.stringify(t.customProperties);i=[r];break;case 5:i=[t.body];break;case 8:case 9:i=[t.itemId];break;case 7:i=[OSF.DDA.OutlookAppOm.$e(t.requiredAttendees),OSF.DDA.OutlookAppOm.$e(t.optionalAttendees),t.start,t.end,t.location,OSF.DDA.OutlookAppOm.$e(t.resources),t.subject,t.body];break;case 11:case 10:i=[t.htmlBody];break;default:break}return i};OSF.DDA.OutlookAppOm.$e=function(n){return n?n.join(";"):null};OSF.DDA.OutlookAppOm.$1t=function(n,t){if($h.ScriptHelpers.isNullOrUndefined(n))return null;OSF.DDA.OutlookAppOm.$H(n,Array,t);var r=n;var u=null;var f=!1;OSF.DDA.OutlookAppOm.$T(r.length,0,OSF.DDA.OutlookAppOm.$1i,String.format("{0}.length",t));for(var e=0;e<r.length;e++)if($h.EmailAddressDetails.isInstanceOfType(r[e])){f=!0;break}f&&(u=[]);for(var i=0;i<r.length;i++)if(f){u[i]=$h.EmailAddressDetails.isInstanceOfType(r[i])?r[i].emailAddress:r[i];OSF.DDA.OutlookAppOm.$H(u[i],String,String.format("{0}[{1}]",t,i))}else OSF.DDA.OutlookAppOm.$H(r[i],String,String.format("{0}[{1}]",t,i));return u};OSF.DDA.OutlookAppOm.prototype={$3_0:null,$R_0:null,$1s_0:null,$1J_0:null,$L_0:null,$18_0:null,get_$O_0:function(){return this.$L_0.get_appName()},initialize:function(n){var t="itemType";this.$3_0=new $h.InitialData(n);1===n[t]?this.$R_0=new $h.Message(this.$3_0):3===n[t]?this.$R_0=new $h.MeetingRequest(this.$3_0):2===n[t]&&(this.$R_0=new $h.Appointment(this.$3_0));this.$1s_0=new $h.UserProfile(this.$3_0);this.$1J_0=new $h.Diagnostics(this.$3_0,this.$L_0.get_appName());$h.InitialData.$1(this,"item",this.$$d_$2h_0);$h.InitialData.$1(this,"userProfile",this.$$d_$31_0);$h.InitialData.$1(this,"diagnostics",this.$$d_$2X_0);OSF.DDA.OutlookAppOm.$4.get_$O_0()===64&&$h.InitialData.$1(this,"ewsUrl",this.$$d_$2Z_0)},makeEwsRequestAsync:function(n,t,i){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");if(n.length>OSF.DDA.OutlookAppOm.$1g)throw Error.argument("data",_u.ExtensibilityStrings.l_EwsRequestOversized_Text);OSF.DDA.OutlookAppOm.$C(this.$3_0.get_$8_0(),2,"makeEwsRequestAsync");var r=new $h.EwsRequest(i);var u=this;r.onreadystatechange=function(){4===r.get_$1l_1()&&t(r.$P_0)};r.send(n)},recordDataPoint:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$7_0(0,"RecordDataPoint",n,null)},recordTrace:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$7_0(0,"RecordTrace",n,null)},trackCtq:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$7_0(0,"TrackCtq",n,null)},convertToLocalClientTime:function(n){var t=new Date(n.getTime());var i=t.getTimezoneOffset()*-1;if(this.$3_0&&this.$3_0.get_$13_0()){t.setUTCMinutes(t.getUTCMinutes()-i);i=this.$1P_0(t);t.setUTCMinutes(t.getUTCMinutes()+i)}var r=this.$g_0(t);r.timezoneOffset=i;return r},convertToUtcClientTime:function(n){var t=this.$2D_0(n);if(this.$3_0&&this.$3_0.get_$13_0()){var i=this.$1P_0(t);t.setUTCMinutes(t.getUTCMinutes()-i);i=n.timezoneOffset?n.timezoneOffset:t.getTimezoneOffset()*-1;t.setUTCMinutes(t.getUTCMinutes()+i)}return t},getUserIdentityTokenAsync:function(n,t){OSF.DDA.OutlookAppOm.$C(this.$3_0.get_$8_0(),1,"getUserIdentityTokenAsync");this.$1c_0(2,"GetUserIdentityToken",n,t)},getCallbackTokenAsync:function(n,t){OSF.DDA.OutlookAppOm.$C(this.$3_0.get_$8_0(),1,"getCallbackTokenAsync");if(64!==this.$L_0.get_appName())throw Error.notImplemented("The getCallbackTokenAsync is not supported by outlook for now.");this.$1c_0(12,"GetCallbackToken",n,t)},displayMessageForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.$7_0(8,"DisplayExistingMessageForm",{itemId:n},null)},displayAppointmentForm:function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("itemId");this.$7_0(9,"DisplayExistingAppointmentForm",{itemId:n},null)},displayNewAppointmentForm:function(n){var u=OSF.DDA.OutlookAppOm.$1t(n.requiredAttendees,"requiredAttendees");var r=OSF.DDA.OutlookAppOm.$1t(n.optionalAttendees,"optionalAttendees");OSF.DDA.OutlookAppOm.$17(n.location,0,OSF.DDA.OutlookAppOm.$1h,"location");OSF.DDA.OutlookAppOm.$17(n.body,0,OSF.DDA.OutlookAppOm.$S,"body");OSF.DDA.OutlookAppOm.$17(n.subject,0,OSF.DDA.OutlookAppOm.$1j,"subject");if(!$h.ScriptHelpers.isNullOrUndefined(n.start)){OSF.DDA.OutlookAppOm.$H(n.start,Date,"start");var o=n.start;n.start=o.getTime();if(!$h.ScriptHelpers.isNullOrUndefined(n.end)){OSF.DDA.OutlookAppOm.$H(n.end,Date,"end");var i=n.end;if(i<o)throw Error.argumentOutOfRange("end",i,_u.ExtensibilityStrings.l_InvalidEventDates_Text);n.end=i.getTime()}}var t=null;if(u||r){t={};var s=n;for(var f in s){var e={key:f,value:s[f]};t[e.key]=e.value}u&&(t.requiredAttendees=u);r&&(t.optionalAttendees=r)}this.$7_0(7,"DisplayNewAppointmentForm",t||n,null)},$1M_0:function(n){$h.ScriptHelpers.isNullOrUndefined(n)||OSF.DDA.OutlookAppOm.$T(n.length,0,OSF.DDA.OutlookAppOm.$S,"htmlBody");this.$7_0(10,"DisplayReplyForm",{htmlBody:n},null)},$1L_0:function(n){$h.ScriptHelpers.isNullOrUndefined(n)||OSF.DDA.OutlookAppOm.$T(n.length,0,OSF.DDA.OutlookAppOm.$S,"htmlBody");this.$7_0(11,"DisplayReplyAllForm",{htmlBody:n},null)},$7_0:function(n,t,i,r){if(64===this.$L_0.get_appName())OSF._OfficeAppFactory.getClientEndPoint().invoke(t,r,i);else if(n){var u=OSF.DDA.OutlookAppOm.$21(n,i);var f=this;window.external.Execute(n,u,function(n,t){if(r){var u=n.getItem(0);var i=JSON.parse(u);r(t,i)}})}else r&&r(-2,null)},$2D_0:function(n){var t=new Date(n.year,n.month,n.date,n.hours,n.minutes,n.seconds,n.milliseconds?n.milliseconds:0);if(isNaN(t.getTime()))throw Error.format(_u.ExtensibilityStrings.l_InvalidDate_Text);return t},$g_0:function(n){var t={};t.month=n.getMonth();t.date=n.getDate();t.year=n.getFullYear();t.hours=n.getHours();t.minutes=n.getMinutes();t.seconds=n.getSeconds();t.milliseconds=n.getMilliseconds();return t},$2e_0:function(n,t){if(!n){this.initialize(t);this.displayName="mailbox";window.setTimeout(this.$$d_$1w_0,0)}},$1w_0:function(){this.$18_0()},$1c_0:function(n,t,i,r){if($h.ScriptHelpers.isNullOrUndefined(i))throw Error.argumentNull("callback");var u=this;this.$7_0(n,t,null,function(n,t){var u;if(n)u=OSF.DDA.OutlookAppOm.$9(null,1,String.format(_u.ExtensibilityStrings.l_InternalProtocolError_Text,n),r);else{var f=t;u=f.wasSuccessful?OSF.DDA.OutlookAppOm.$9(f.token,0,null,r):OSF.DDA.OutlookAppOm.$9(null,1,f.errorMessage,r)}i(u)})},$2h_0:function(){return this.$R_0},$31_0:function(){OSF.DDA.OutlookAppOm.$D(this.$3_0.get_$8_0());return this.$1s_0},$2X_0:function(){return this.$1J_0},$2Z_0:function(){OSF.DDA.OutlookAppOm.$D(this.$3_0.get_$8_0());return this.$3_0.get_$2F_0()},$1P_0:function(n){for(var r=this.$3_0.get_$13_0(),i=0;i<r.length;i++){var t=r[i];var f=parseInt(t.start);var u=parseInt(t.end);if(n.getTime()-f>=0&&n.getTime()-u<0)return parseInt(t.offset)}throw Error.format(_u.ExtensibilityStrings.l_InvalidDate_Text);},$19_0:function(){var n=!1;try{n=!$h.ScriptHelpers.isNullOrUndefined(_u.ExtensibilityStrings.l_EwsRequestOversized_Text)}catch(t){}return n},$36_0:function(n){for(var s=null,l="",a=document.getElementsByTagName("script"),o=a.length-1;o>=0;o--){var i=null;var v=a[o].attributes;if(v){var p=v.getNamedItem("src");p&&(i=p.value);if(i){var y=!1;i=i.toLowerCase();var f=i.indexOf("office_strings.js");if(f<0){f=i.indexOf("office_strings.debug.js");y=!0}if(f>0&&f<i.length){s=i.replace(y?"office_strings.debug.js":"office_strings.js","outlook_strings.js");var r=i.substring(0,f);var u=r.lastIndexOf("/",r.length-2);u===-1&&(u=r.lastIndexOf("\\",r.length-2));u!==-1&&r.length>u+1&&(l=r.substring(0,u+1));break}}}}if(s){var h=document.getElementsByTagName("head")[0];var t=null;var b=this;var e=function(){if(n&&(!t.readyState||t.readyState&&(t.readyState==="loaded"||t.readyState==="complete"))){t.onload=null;t.onreadystatechange=null;n()}};var c=this;var w=function(){if(!c.$19_0()){var n=l+"en-us/"+"outlook_strings.js";t.onload=null;t.onreadystatechange=null;t=c.$1G_0(n);t.onload=e;t.onreadystatechange=e;h.appendChild(t)}};t=this.$1G_0(s);t.onload=e;t.onreadystatechange=e;window.setTimeout(w,2e3);h.appendChild(t)}},$1G_0:function(n){var t=document.createElement("script");t.type="text/javascript";t.src=n;return t}};OSF.DDA.Settings=function(n){this.$u_0=n};OSF.DDA.Settings.$20=function(n){if(!n)return{};if(OSF.DDA.OutlookAppOm.$4.get_$O_0()===8){var t=n.SettingsKey;if(t)return OSF.DDA.SettingsManager.deserializeSettings(t)}return n};OSF.DDA.Settings.prototype={$u_0:null,$10_0:null,get_$J_0:function(){if(!this.$10_0){this.$10_0=OSF.DDA.Settings.$20(this.$u_0);this.$u_0=null}return this.$10_0},get:function(n){return this.get_$J_0()[n]},set:function(n,t){this.get_$J_0()[n]=t},remove:function(n){delete this.get_$J_0()[n]},saveAsync:function(){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];var r=null;var u=null;if(n&&n.length>0){var t=n.length-1;if(Function.isInstanceOfType(n[t])){r=n[t];t--;t>=0&&(u=n[t].asyncContext)}}OSF.DDA.OutlookAppOm.$4.get_$O_0()===64?this.$3E_0(r,u):this.$3D_0(r,u)},$3D_0:function(n,t){var r=null;try{var f=OSF.DDA.SettingsManager.serializeSettings(this.get_$J_0());var e=JSON.stringify(f);var u={SettingsKey:e};OSF.DDA.RichClientSettingsManager.write(u)}catch(o){r=o}if(n){var i;i=r?OSF.DDA.OutlookAppOm.$9(null,1,r.message,t):OSF.DDA.OutlookAppOm.$9(null,0,null,t);n(i)}},$3E_0:function(n,t){var i=OSF.DDA.SettingsManager.serializeSettings(this.get_$J_0());var r=this;OSF._OfficeAppFactory.getClientEndPoint().invoke("saveSettingsAsync",function(i,r){if(n){var u;if(i)u=OSF.DDA.OutlookAppOm.$9(null,1,String.format(_u.ExtensibilityStrings.l_InternalProtocolError_Text,i),t);else{var f=r;u=f.error?OSF.DDA.OutlookAppOm.$9(null,1,f.errorMessage,t):OSF.DDA.OutlookAppOm.$9(null,0,null,t)}n(u)}},[i])}};Type.registerNamespace("$h");$h.Appointment=function(n){this.$$d_$2m_1=Function.createDelegate(this,this.$2m_1);this.$$d_$1W_1=Function.createDelegate(this,this.$1W_1);this.$$d_$q_1=Function.createDelegate(this,this.$q_1);this.$$d_$2t_1=Function.createDelegate(this,this.$2t_1);this.$$d_$1Z_1=Function.createDelegate(this,this.$1Z_1);this.$$d_$1X_1=Function.createDelegate(this,this.$1X_1);this.$$d_$n_1=Function.createDelegate(this,this.$n_1);this.$$d_$1T_1=Function.createDelegate(this,this.$1T_1);this.$$d_$1a_1=Function.createDelegate(this,this.$1a_1);$h.Appointment.initializeBase(this,[n]);$h.InitialData.$1(this,"start",this.$$d_$1a_1);$h.InitialData.$1(this,"end",this.$$d_$1T_1);$h.InitialData.$1(this,"location",this.$$d_$n_1);$h.InitialData.$1(this,"optionalAttendees",this.$$d_$1X_1);$h.InitialData.$1(this,"requiredAttendees",this.$$d_$1Z_1);$h.InitialData.$1(this,"resources",this.$$d_$2t_1);$h.InitialData.$1(this,"subject",this.$$d_$q_1);$h.InitialData.$1(this,"normalizedSubject",this.$$d_$1W_1);$h.InitialData.$1(this,"organizer",this.$$d_$2m_1)};$h.Appointment.prototype={getEntities:function(){return this.$0_0.$Q_0()},getEntitiesByType:function(n){return this.$0_0.$1U_0(n)},getRegExMatches:function(){OSF.DDA.OutlookAppOm.$C(this.$0_0.get_$8_0(),1,"getRegExMatches");return this.$0_0.$p_0()},getFilteredEntitiesByName:function(n){return this.$0_0.$m_0(n)},getRegExMatchesByName:function(n){OSF.DDA.OutlookAppOm.$C(this.$0_0.get_$8_0(),1,"getRegExMatchesByName");return this.$0_0.$1Y_0(n)},displayReplyForm:function(n){OSF.DDA.OutlookAppOm.$4.$1M_0(n)},displayReplyAllForm:function(n){OSF.DDA.OutlookAppOm.$4.$1L_0(n)},getItemType:function(){return Microsoft.Office.WebExtension.MailboxEnums.ItemType.Appointment},$1a_1:function(){return this.$0_0.get_$1m_0()},$1T_1:function(){return this.$0_0.get_$1N_0()},$n_1:function(){return this.$0_0.get_$1f_0()},$1X_1:function(){return this.$0_0.get_$a_0()},$1Z_1:function(){return this.$0_0.get_$14_0()},$2t_1:function(){return this.$0_0.get_$3C_0()},$q_1:function(){return this.$0_0.get_$1p_0()},$1W_1:function(){return this.$0_0.get_$1k_0()},$2m_1:function(){return this.$0_0.get_$37_0()}};$h.AttachmentDetails=function(n){this.$$d_$2g_0=Function.createDelegate(this,this.$2g_0);this.$$d_$2N_0=Function.createDelegate(this,this.$2N_0);this.$$d_$2v_0=Function.createDelegate(this,this.$2v_0);this.$$d_$2T_0=Function.createDelegate(this,this.$2T_0);this.$$d_$2l_0=Function.createDelegate(this,this.$2l_0);this.$$d_$2d_0=Function.createDelegate(this,this.$2d_0);this.$0_0=n;$h.InitialData.$1(this,"id",this.$$d_$2d_0);$h.InitialData.$1(this,"name",this.$$d_$2l_0);$h.InitialData.$1(this,"contentType",this.$$d_$2T_0);$h.InitialData.$1(this,"size",this.$$d_$2v_0);$h.InitialData.$1(this,"attachmentType",this.$$d_$2N_0);$h.InitialData.$1(this,"isInline",this.$$d_$2g_0)};$h.AttachmentDetails.prototype={$0_0:null,$2d_0:function(){return this.$0_0.id},$2l_0:function(){return this.$0_0.name},$2T_0:function(){return this.$0_0.contentType},$2v_0:function(){return this.$0_0.size},$2N_0:function(){var n=this.$0_0.attachmentType;return n<$h.AttachmentDetails.$Y.length?$h.AttachmentDetails.$Y[n]:Microsoft.Office.WebExtension.MailboxEnums.AttachmentType.File},$2g_0:function(){return this.$0_0.isInline}};$h.Contact=function(n){this.$$d_$2S_0=Function.createDelegate(this,this.$2S_0);this.$$d_$k_0=Function.createDelegate(this,this.$k_0);this.$$d_$r_0=Function.createDelegate(this,this.$r_0);this.$$d_$l_0=Function.createDelegate(this,this.$l_0);this.$$d_$o_0=Function.createDelegate(this,this.$o_0);this.$$d_$2P_0=Function.createDelegate(this,this.$2P_0);this.$$d_$2p_0=Function.createDelegate(this,this.$2p_0);this.$0_0=n;$h.InitialData.$1(this,"personName",this.$$d_$2p_0);$h.InitialData.$1(this,"businessName",this.$$d_$2P_0);$h.InitialData.$1(this,"phoneNumbers",this.$$d_$o_0);$h.InitialData.$1(this,"emailAddresses",this.$$d_$l_0);$h.InitialData.$1(this,"urls",this.$$d_$r_0);$h.InitialData.$1(this,"addresses",this.$$d_$k_0);$h.InitialData.$1(this,"contactString",this.$$d_$2S_0)};$h.Contact.prototype={$0_0:null,$G_0:null,$2p_0:function(){return this.$0_0.PersonName},$2P_0:function(){return this.$0_0.BusinessName},$k_0:function(){return $h.Entities.$A(this.$0_0,"Addresses")},$l_0:function(){return $h.Entities.$A(this.$0_0,"EmailAddresses")},$r_0:function(){return $h.Entities.$A(this.$0_0,"Urls")},$o_0:function(){if(!this.$G_0){var n=this;this.$G_0=$h.Entities.$3K($h.PhoneNumber,this.$0_0,"PhoneNumbers",function(n){return new $h.PhoneNumber(n)})}return this.$G_0},$2S_0:function(){return this.$0_0.ContactString}};$h.CustomProperties=function(n){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("data");this.$0_0=n};$h.CustomProperties.prototype={$0_0:null,get:function(n){var i=this.$0_0[n];if(typeof i=="string"){var t=i;if(t.length>6&&t.startsWith("Date(")&&t.endsWith(")")){var f=t.substring(5,t.length-1);var r=parseInt(f);if(!isNaN(r)){var u=new Date(r);u&&(i=u)}}}return i},set:function(n,t){OSF.OUtil.isDate(t)&&(t="Date("+t.getTime()+")");this.$0_0[n]=t},remove:function(n){delete this.$0_0[n]},saveAsync:function(n,t){var r=2500;if(JSON.stringify(this.$0_0).length>r)throw Error.argument();var i=new $h.SaveDictionaryRequest(n,t);i.$z_0(4,"SaveCustomProperties",{customProperties:this.$0_0})}};$h.Diagnostics=function(n,t){this.$$d_$2o_0=Function.createDelegate(this,this.$2o_0);this.$$d_$2c_0=Function.createDelegate(this,this.$2c_0);this.$$d_$2b_0=Function.createDelegate(this,this.$2b_0);this.$0_0=n;this.$N_0=t;$h.InitialData.$1(this,"hostName",this.$$d_$2b_0);$h.InitialData.$1(this,"hostVersion",this.$$d_$2c_0);64===this.$N_0&&$h.InitialData.$1(this,"OWAView",this.$$d_$2o_0)};$h.Diagnostics.prototype={$0_0:null,$N_0:0,$2b_0:function(){if(8===this.$N_0)return"Outlook";else if(64===this.$N_0)return"OutlookWebApp";return null},$2c_0:function(){return this.$0_0.get_$32_0()},$2o_0:function(){return this.$0_0.get_$38_0()}};$h.EmailAddressDetails=function(n){this.$$d_$2s_0=Function.createDelegate(this,this.$2s_0);this.$$d_$2K_0=Function.createDelegate(this,this.$2K_0);this.$$d_$1R_0=Function.createDelegate(this,this.$1R_0);this.$$d_$1S_0=Function.createDelegate(this,this.$1S_0);this.$0_0=n;$h.InitialData.$1(this,"emailAddress",this.$$d_$1S_0);$h.InitialData.$1(this,"displayName",this.$$d_$1R_0);$h.ScriptHelpers.dictionaryContainsKey(n,"appointmentResponse")&&$h.InitialData.$1(this,"appointmentResponse",this.$$d_$2K_0);$h.ScriptHelpers.dictionaryContainsKey(n,"recipientType")&&$h.InitialData.$1(this,"recipientType",this.$$d_$2s_0)};$h.EmailAddressDetails.$1D=function(n){var t={};var r=n.Name;var i=n.UserId;t.name=r||$h.EmailAddressDetails.$i;t.address=i||$h.EmailAddressDetails.$i;return new $h.EmailAddressDetails(t)};$h.EmailAddressDetails.prototype={$0_0:null,$1S_0:function(){return this.$0_0.address},$1R_0:function(){return this.$0_0.name},$2K_0:function(){var n=this.$0_0.appointmentResponse;return n<$h.EmailAddressDetails.$y.length?$h.EmailAddressDetails.$y[n]:Microsoft.Office.WebExtension.MailboxEnums.ResponseType.None},$2s_0:function(){var n=this.$0_0.recipientType;return n<$h.EmailAddressDetails.$v.length?$h.EmailAddressDetails.$v[n]:Microsoft.Office.WebExtension.MailboxEnums.RecipientType.Other}};$h.Entities=function(n,t,i,r){this.$$d_$24_0=Function.createDelegate(this,this.$24_0);this.$$d_$1Q_0=Function.createDelegate(this,this.$1Q_0);this.$$d_$o_0=Function.createDelegate(this,this.$o_0);this.$$d_$r_0=Function.createDelegate(this,this.$r_0);this.$$d_$l_0=Function.createDelegate(this,this.$l_0);this.$$d_$1V_0=Function.createDelegate(this,this.$1V_0);this.$$d_$1b_0=Function.createDelegate(this,this.$1b_0);this.$$d_$k_0=Function.createDelegate(this,this.$k_0);this.$0_0=n||{};this.$1O_0=t||{};this.$K_0=i;$h.InitialData.$1(this,"addresses",this.$$d_$k_0);$h.InitialData.$1(this,"taskSuggestions",this.$$d_$1b_0);$h.InitialData.$1(this,"meetingSuggestions",this.$$d_$1V_0);$h.InitialData.$1(this,"emailAddresses",this.$$d_$l_0);$h.InitialData.$1(this,"urls",this.$$d_$r_0);$h.InitialData.$1(this,"phoneNumbers",this.$$d_$o_0);$h.InitialData.$1(this,"contacts",this.$$d_$1Q_0);this.$M_0=r};$h.Entities.$3K=function(n,t,i,r,u,f){var s=null;var e=t[i];if(!e)return new Array(0);u&&(e=$h.Entities.$3L(Object,e,$h.Entities.$2E,f));s=new Array(e.length);for(var l=0,h=e,a=h.length,o=0;o<a;++o){var c=h[o];s[l++]=r(c)}return s};$h.Entities.$A=function(n,t,i){var r=n[t];if(!r)return new Array(0);i&&(r=$h.Entities.$3L(String,r,$h.Entities.$3G,null));return r};$h.Entities.$1B=function(n){return new $h.Contact(n)};$h.Entities.$1H=function(n){return new $h.TaskSuggestion(n)};$h.Entities.$1E=function(n){return new $h.PhoneNumber(n)};$h.Entities.$2E=function(n,t,i){return n===t?!0:!n||!t?!1:n[i]===t[i]?!0:!1};$h.Entities.$3G=function(n,t,i){return n===t};$h.Entities.$3L=function(n,t,i,r){for(var u=t.length-1;u>=0;u--){for(var e=!1,f=u-1;f>=0;f--)if(i(t[u],t[f],r)){e=!0;break}e&&Array.removeAt(t,u)}return t};$h.Entities.prototype={$K_0:null,$0_0:null,$1O_0:null,$6_0:null,$M_0:0,$11_0:null,$s_0:null,$G_0:null,$d_0:null,$U_0:null,$h_0:null,$16_0:null,$2Q_0:function(n){if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.MeetingSuggestion)return this.$1V_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.TaskSuggestion)return this.$1b_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.Address)return this.$k_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.PhoneNumber)return this.$o_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.EmailAddress)return this.$l_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.Url)return this.$r_0();else if(n===Microsoft.Office.WebExtension.MailboxEnums.EntityType.Contact)return this.$1Q_0();return null},$m_0:function(n){this.$6_0||(this.$6_0={});if(!$h.ScriptHelpers.dictionaryContainsKey(this.$6_0,n)){for(var r=!1,i=0;i<$h.Entities.$V.length;i++){var u=$h.Entities.$V[i];var t=this.$1O_0[u];if(t&&$h.ScriptHelpers.dictionaryContainsKey(t,n)){switch(u){case"EmailAddresses":case"Urls":this.$6_0[n]=$h.Entities.$A(t,n);break;case"Addresses":this.$6_0[n]=$h.Entities.$A(t,n,!0);break;case"PhoneNumbers":this.$6_0[n]=$h.Entities.$3K($h.PhoneNumber,t,n,$h.Entities.$1E,!1,null);break;case"TaskSuggestions":this.$6_0[n]=$h.Entities.$3K($h.TaskSuggestion,t,n,$h.Entities.$1H,!0,"TaskString");break;case"MeetingSuggestions":this.$6_0[n]=$h.Entities.$3K($h.MeetingSuggestion,t,n,this.$$d_$24_0,!0,"MeetingString");break;case"Contacts":this.$6_0[n]=$h.Entities.$3K($h.Contact,t,n,$h.Entities.$1B,!0,"ContactString");break}r=!0;break}}r||(this.$6_0[n]=null)}return this.$6_0[n]},$24_0:function(n){return new $h.MeetingSuggestion(n,this.$K_0)},$k_0:function(){this.$U_0||(this.$U_0=$h.Entities.$A(this.$0_0,"Addresses",!0));return this.$U_0},$l_0:function(){OSF.DDA.OutlookAppOm.$D(this.$M_0);this.$h_0||(this.$h_0=$h.Entities.$A(this.$0_0,"EmailAddresses",!1));return this.$h_0},$r_0:function(){this.$16_0||(this.$16_0=$h.Entities.$A(this.$0_0,"Urls",!1));return this.$16_0},$o_0:function(){this.$G_0||(this.$G_0=$h.Entities.$3K($h.PhoneNumber,this.$0_0,"PhoneNumbers",$h.Entities.$1E));return this.$G_0},$1b_0:function(){OSF.DDA.OutlookAppOm.$D(this.$M_0);this.$11_0||(this.$11_0=$h.Entities.$3K($h.TaskSuggestion,this.$0_0,"TaskSuggestions",$h.Entities.$1H,!0,"TaskString"));return this.$11_0},$1V_0:function(){OSF.DDA.OutlookAppOm.$D(this.$M_0);this.$s_0||(this.$s_0=$h.Entities.$3K($h.MeetingSuggestion,this.$0_0,"MeetingSuggestions",this.$$d_$24_0,!0,"MeetingString"));return this.$s_0},$1Q_0:function(){OSF.DDA.OutlookAppOm.$D(this.$M_0);this.$d_0||(this.$d_0=$h.Entities.$3K($h.Contact,this.$0_0,"Contacts",$h.Entities.$1B,!0,"ContactString"));return this.$d_0}};$h.Item=function(n){this.$$d_$23_0=Function.createDelegate(this,this.$23_0);this.$$d_$2M_0=Function.createDelegate(this,this.$2M_0);this.$$d_$2i_0=Function.createDelegate(this,this.$2i_0);this.$$d_$2j_0=Function.createDelegate(this,this.$2j_0);this.$$d_$2W_0=Function.createDelegate(this,this.$2W_0);this.$$d_$2V_0=Function.createDelegate(this,this.$2V_0);this.$0_0=n;$h.InitialData.$1(this,"dateTimeCreated",this.$$d_$2V_0);$h.InitialData.$1(this,"dateTimeModified",this.$$d_$2W_0);$h.InitialData.$1(this,"itemId",this.$$d_$2j_0);var t=this;$h.InitialData.$1(this,"itemType",function(){return t.getItemType()});$h.InitialData.$1(this,"itemClass",this.$$d_$2i_0);OSF.DDA.OutlookAppOm.$4.get_$O_0()===64&&$h.InitialData.$1(this,"attachments",this.$$d_$2M_0)};$h.Item.prototype={$0_0:null,loadCustomPropertiesAsync:function(n,t){if($h.ScriptHelpers.isNullOrUndefined(n))throw Error.argumentNull("callback");var i=new $h.LoadDictionaryRequest(this.$$d_$23_0,"customProperties",n,t);i.$z_0(3,"LoadCustomProperties",{})},$23_0:function(n){return new $h.CustomProperties(n)},$2j_0:function(){return this.$0_0.get_$35_0()},$2i_0:function(){return this.$0_0.get_$34_0()},$2V_0:function(){return this.$0_0.get_$26_0()},$2W_0:function(){return this.$0_0.get_$27_0()},$2M_0:function(){return this.$0_0.get_$1v_0()}};$h.MeetingRequest=function(n){this.$$d_$1Z_2=Function.createDelegate(this,this.$1Z_2);this.$$d_$1X_2=Function.createDelegate(this,this.$1X_2);this.$$d_$n_2=Function.createDelegate(this,this.$n_2);this.$$d_$1T_2=Function.createDelegate(this,this.$1T_2);this.$$d_$1a_2=Function.createDelegate(this,this.$1a_2);$h.MeetingRequest.initializeBase(this,[n]);$h.InitialData.$1(this,"start",this.$$d_$1a_2);$h.InitialData.$1(this,"end",this.$$d_$1T_2);$h.InitialData.$1(this,"location",this.$$d_$n_2);$h.InitialData.$1(this,"optionalAttendees",this.$$d_$1X_2);$h.InitialData.$1(this,"requiredAttendees",this.$$d_$1Z_2)};$h.MeetingRequest.prototype={$1a_2:function(){return this.$0_0.get_$1m_0()},$1T_2:function(){return this.$0_0.get_$1N_0()},$n_2:function(){return this.$0_0.get_$1f_0()},$1X_2:function(){return this.$0_0.get_$a_0()},$1Z_2:function(){return this.$0_0.get_$14_0()}};$h.MeetingSuggestion=function(n,t){this.$$d_$2Y_0=Function.createDelegate(this,this.$2Y_0);this.$$d_$2w_0=Function.createDelegate(this,this.$2w_0);this.$$d_$q_0=Function.createDelegate(this,this.$q_0);this.$$d_$n_0=Function.createDelegate(this,this.$n_0);this.$$d_$2O_0=Function.createDelegate(this,this.$2O_0);this.$$d_$2k_0=Function.createDelegate(this,this.$2k_0);this.$0_0=n;this.$K_0=t;$h.InitialData.$1(this,"meetingString",this.$$d_$2k_0);$h.InitialData.$1(this,"attendees",this.$$d_$2O_0);$h.InitialData.$1(this,"location",this.$$d_$n_0);$h.InitialData.$1(this,"subject",this.$$d_$q_0);$h.InitialData.$1(this,"start",this.$$d_$2w_0);$h.InitialData.$1(this,"end",this.$$d_$2Y_0)};$h.MeetingSuggestion.prototype={$K_0:null,$0_0:null,$Z_0:null,$2k_0:function(){return this.$0_0.MeetingString},$n_0:function(){return this.$0_0.Location},$q_0:function(){return this.$0_0.Subject},$2w_0:function(){var n=this.$1C_0("StartTime");var t=$h.MeetingSuggestionTimeDecoder.resolve(n,this.$K_0);return t.getTime()!==n.getTime()?OSF.DDA.OutlookAppOm.$4.convertToUtcClientTime(OSF.DDA.OutlookAppOm.$4.$g_0(t)):n},$2Y_0:function(){var n=this.$1C_0("EndTime");var t=$h.MeetingSuggestionTimeDecoder.resolve(n,this.$K_0);return t.getTime()!==n.getTime()?OSF.DDA.OutlookAppOm.$4.convertToUtcClientTime(OSF.DDA.OutlookAppOm.$4.$g_0(t)):n},$1C_0:function(n){var t=this.$0_0[n];return t?new Date(t):null},$2O_0:function(){if(!this.$Z_0){var n=this;this.$Z_0=$h.Entities.$3K($h.EmailAddressDetails,this.$0_0,"Attendees",function(n){return $h.EmailAddressDetails.$1D(n)})}return this.$Z_0}};$h.MeetingSuggestionTimeDecoder=function(){};$h.MeetingSuggestionTimeDecoder.resolve=function(n,t){if(!t)return n;try{var f;var i;var r;var u=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0);var s,o,e;if(e=$h.MeetingSuggestionTimeDecoder.$2A(n,s={val:r},o={val:f}),r=s.val,f=o.val,e){i=$h.PreciseDate.isInstanceOfType(r)?$h.MeetingSuggestionTimeDecoder.$3A(u,r):$h.RelativeDate.isInstanceOfType(r)?$h.MeetingSuggestionTimeDecoder.$3B(u,r):u;if(isNaN(i.getTime()))return t;i.setMilliseconds(i.getMilliseconds()+f);return i}else return n}catch(h){return t}};$h.MeetingSuggestionTimeDecoder.$1d=function(n){return null===n||n===undefined};$h.MeetingSuggestionTimeDecoder.$3A=function(n,t){var r=t.$1u_1;var f=t.$t_1?t.$t_1-1:n.getMonth();var u=t.$1I_1;if(!u)return n;var i;if($h.MeetingSuggestionTimeDecoder.$1d(r)){i=new Date(n.getFullYear(),f,u);i.getTime()<n.getTime()&&(i=new Date(n.getFullYear()+1,f,u))}else i=new Date(r<50?2e3+r:1900+r,f,u);return i.getMonth()!==f?n:i};$h.MeetingSuggestionTimeDecoder.$3B=function(n,t){var i;switch(t.$1q_1){case 0:i=new Date(n.getFullYear(),n.getMonth(),n.getDate());i.setDate(i.getDate()+t.$5_1);return i;case 5:return $h.MeetingSuggestionTimeDecoder.$2G(n,t.$5_1,t.$B_1);case 2:var r=1;switch(t.$F_1){case 1:break;case 2:r=16;break;default:t.$5_1||(r=n.getDate());break}i=new Date(n.getFullYear(),n.getMonth(),r);i.setMonth(i.getMonth()+t.$5_1);i.getTime()<n.getTime()&&i.setDate(i.getDate()+n.getDate()-1);return i;case 1:i=new Date(n.getFullYear(),n.getMonth(),n.getDate());i.setDate(n.getDate()+7*t.$5_1);if(t.$F_1!==1&&t.$F_1){if(t.$F_1===2){i.setDate(i.getDate()+5-i.getDay());return i}}else{i.setDate(i.getDate()+1-i.getDay());return i.getTime()<n.getTime()?n:i}break;case 4:return $h.MeetingSuggestionTimeDecoder.$2H(n,t);case 3:if(t.$5_1>0)return new Date(n.getFullYear()+t.$5_1,0,1);break;default:break}return n};$h.MeetingSuggestionTimeDecoder.$2G=function(n,t,i){if(t>-5&&t<5){var u;var f;u=(i+6)%7+1;f=7*t+(u-n.getDay());n.setDate(n.getDate()+f);return n}else{var r=(i-n.getDay())%7;r<0&&(r+=7);n.setDate(n.getDate()+r);return n}};$h.MeetingSuggestionTimeDecoder.$2H=function(n,t){var f;var i;var r;f=n;if(t.$B_1<=0||t.$B_1>12||t.$5_1<=0||t.$5_1>5)return n;var e=(12+t.$B_1-f.getMonth()-1)%12;i=new Date(f.getFullYear(),f.getMonth()+e,1);if(t.$F_1===1)if(t.$5_1===1&&i.getDay()!==6&&i.getDay()!==0)return i;else{r=new Date(i.getFullYear(),i.getMonth(),i.getDate());r.setDate(r.getDate()+(8-i.getDay())%7);i.getDay()!==6&&i.getDay()!==0&&i.getDay()!==1&&r.setDate(r.getDate()-7);r.setDate(r.getDate()+7*(t.$5_1-1));return r.getMonth()+1!==t.$B_1?n:r}else{r=new Date(i.getFullYear(),i.getMonth(),$h.MeetingSuggestionTimeDecoder.$29(i.getMonth(),i.getFullYear()));var u=1-r.getDay();u>0&&(u=u-7);r.setDate(r.getDate()+u);r.setDate(r.getDate()+7*(1-t.$5_1));return r.getMonth()+1!==t.$B_1?i.getDay()!==6&&i.getDay()!==0?i:n:r}};$h.MeetingSuggestionTimeDecoder.$2A=function(n,t,i){var f=32767;t.val=null;i.val=0;if(!n)return!1;i.val=$h.MeetingSuggestionTimeDecoder.$2y(n);var e=n.getTime()-i.val;var r=(e-$h.MeetingSuggestionTimeDecoder.$1A.getTime())/864e5;if(r<0)return!1;else if(r>=262144)return!1;else{var u=r>>15;r=r&f;switch(u){case 0:return $h.MeetingSuggestionTimeDecoder.$2B(r,t);case 1:return $h.MeetingSuggestionTimeDecoder.$2C(r,t);default:return!1}}};$h.MeetingSuggestionTimeDecoder.$2B=function(n,t){var h=7;var e=15;var o=31;var s=127;var u=null;var r=0;var f=0;t.val=null;var i=n>>12&h;if((i&4)==4){u=n>>5&s;if((i&2)==2){if((i&1)==1)return!1;r=n>>1&e}}else{(i&2)==2&&(r=n>>8&e);(i&1)==1&&(f=n>>3&o)}t.val=new $h.PreciseDate(f,r,u);return!0};$h.MeetingSuggestionTimeDecoder.$2C=function(n,t){var o=15;var e=63;var h=7;var s=3;var r=n&o;n>>=4;var i=$h.MeetingSuggestionTimeDecoder.$2J(n&e,6);n>>=6;var f=n&h;n>>=3;var u=n&s;try{t.val=new $h.RelativeDate(u,i,f,r);return!0}catch(c){t.val=null;return!1}};$h.MeetingSuggestionTimeDecoder.$2J=function(n,t){var i=1<<t-1;var r=(1<<t)-1;return(n&i)===i?-((n^r)+1):n};$h.MeetingSuggestionTimeDecoder.$29=function(n,t){return 32-new Date(t,n,32).getDate()};$h.MeetingSuggestionTimeDecoder.$2y=function(n){var t=0;t+=n.getUTCHours()*3600;t+=n.getUTCMinutes()*60;t+=n.getUTCSeconds();t*=1e3;t+=n.getUTCMilliseconds();return t};$h.ExtractedDate=function(){};$h.PreciseDate=function(n,t,i){$h.PreciseDate.initializeBase(this);this.$1I_1=n;this.$t_1=t;$h.MeetingSuggestionTimeDecoder.$1d(i)||(this.$1u_1=i%100)};$h.PreciseDate.prototype={$1I_1:0,$t_1:0,$1u_1:null};$h.RelativeDate=function(n,t,i,r){$h.RelativeDate.initializeBase(this);this.$F_1=n;this.$5_1=t;this.$1q_1=i;this.$B_1=r};$h.RelativeDate.prototype={$F_1:0,$5_1:0,$1q_1:0,$B_1:0};$h.Message=function(n){this.$$d_$2U_1=Function.createDelegate(this,this.$2U_1);this.$$d_$2f_1=Function.createDelegate(this,this.$2f_1);this.$$d_$2R_1=Function.createDelegate(this,this.$2R_1);this.$$d_$30_1=Function.createDelegate(this,this.$30_1);this.$$d_$2a_1=Function.createDelegate(this,this.$2a_1);this.$$d_$2u_1=Function.createDelegate(this,this.$2u_1);this.$$d_$1W_1=Function.createDelegate(this,this.$1W_1);this.$$d_$q_1=Function.createDelegate(this,this.$q_1);$h.Message.initializeBase(this,[n]);$h.InitialData.$1(this,"subject",this.$$d_$q_1);$h.InitialData.$1(this,"normalizedSubject",this.$$d_$1W_1);$h.InitialData.$1(this,"sender",this.$$d_$2u_1);$h.InitialData.$1(this,"from",this.$$d_$2a_1);$h.InitialData.$1(this,"to",this.$$d_$30_1);$h.InitialData.$1(this,"cc",this.$$d_$2R_1);$h.InitialData.$1(this,"internetMessageId",this.$$d_$2f_1);$h.InitialData.$1(this,"conversationId",this.$$d_$2U_1)};$h.Message.prototype={getEntities:function(){return this.$0_0.$Q_0()},getEntitiesByType:function(n){return this.$0_0.$1U_0(n)},getFilteredEntitiesByName:function(n){return this.$0_0.$m_0(n)},getRegExMatches:function(){OSF.DDA.OutlookAppOm.$C(this.$0_0.get_$8_0(),1,"getRegExMatches");return this.$0_0.$p_0()},getRegExMatchesByName:function(n){OSF.DDA.OutlookAppOm.$C(this.$0_0.get_$8_0(),1,"getRegExMatchesByName");return this.$0_0.$1Y_0(n)},displayReplyForm:function(n){OSF.DDA.OutlookAppOm.$4.$1M_0(n)},displayReplyAllForm:function(n){OSF.DDA.OutlookAppOm.$4.$1L_0(n)},getItemType:function(){return Microsoft.Office.WebExtension.MailboxEnums.ItemType.Message},$q_1:function(){return this.$0_0.get_$1p_0()},$1W_1:function(){return this.$0_0.get_$1k_0()},$2u_1:function(){return this.$0_0.get_$3F_0()},$2a_1:function(){return this.$0_0.get_$2I_0()},$30_1:function(){return this.$0_0.get_$14_0()},$2R_1:function(){return this.$0_0.get_$a_0()},$2f_1:function(){return this.$0_0.get_$33_0()},$2U_1:function(){return this.$0_0.get_$1z_0()}};$h.PhoneNumber=function(n){this.$$d_$2r_0=Function.createDelegate(this,this.$2r_0);this.$$d_$2n_0=Function.createDelegate(this,this.$2n_0);this.$$d_$2q_0=Function.createDelegate(this,this.$2q_0);this.$0_0=n;$h.InitialData.$1(this,"phoneString",this.$$d_$2q_0);$h.InitialData.$1(this,"originalPhoneString",this.$$d_$2n_0);$h.InitialData.$1(this,"type",this.$$d_$2r_0)};$h.PhoneNumber.prototype={$0_0:null,$2q_0:function(){return this.$0_0.PhoneString},$2n_0:function(){return this.$0_0.OriginalPhoneString},$2r_0:function(){return this.$0_0.Type}};$h.TaskSuggestion=function(n){this.$$d_$2L_0=Function.createDelegate(this,this.$2L_0);this.$$d_$2x_0=Function.createDelegate(this,this.$2x_0);this.$0_0=n;$h.InitialData.$1(this,"taskString",this.$$d_$2x_0);$h.InitialData.$1(this,"assignees",this.$$d_$2L_0)};$h.TaskSuggestion.prototype={$0_0:null,$W_0:null,$2x_0:function(){return this.$0_0.TaskString},$2L_0:function(){if(!this.$W_0){var n=this;this.$W_0=$h.Entities.$3K($h.EmailAddressDetails,this.$0_0,"Assignees",function(n){return $h.EmailAddressDetails.$1D(n)})}return this.$W_0}};$h.UserProfile=function(n){this.$$d_$2z_0=Function.createDelegate(this,this.$2z_0);this.$$d_$1S_0=Function.createDelegate(this,this.$1S_0);this.$$d_$1R_0=Function.createDelegate(this,this.$1R_0);this.$0_0=n;$h.InitialData.$1(this,"displayName",this.$$d_$1R_0);$h.InitialData.$1(this,"emailAddress",this.$$d_$1S_0);$h.InitialData.$1(this,"timeZone",this.$$d_$2z_0)};$h.UserProfile.prototype={$0_0:null,$1R_0:function(){return this.$0_0.get_$3H_0()},$1S_0:function(){return this.$0_0.get_$3I_0()},$2z_0:function(){return this.$0_0.get_$3J_0()}};$h.RequestState=function(){};$h.RequestState.prototype={unsent:0,opened:1,headersReceived:2,loading:3,done:4};$h.RequestState.registerEnum("$h.RequestState",!1);$h.EwsRequest=function(n){this.readyState=1;$h.EwsRequest.initializeBase(this,[n])};$h.EwsRequest.prototype={status:0,statusText:null,onreadystatechange:null,responseText:null,get_$1n_1:function(){return this.status},set_$1n_1:function(n){this.status=n;return n},get_$1o_1:function(){return this.statusText},set_$1o_1:function(n){this.statusText=n;return n},get_$1l_1:function(){return this.readyState},set_$1l_1:function(n){this.readyState=n;return n},get_$x_1:function(){return this.responseText},set_$x_1:function(n){this.responseText=n;return n},send:function(n){this.$1y_1();$h.ScriptHelpers.isNullOrUndefined(n)&&this.$12_1();this.$z_0(5,"EwsRequest",{body:n})},$1x_1:function(){$h.ScriptHelpers.isNullOrUndefined(this.onreadystatechange)||this.onreadystatechange()},$39_1:function(n){}};$h.InitialData=function(n){this.$0_0=n};$h.InitialData.$1=function(n,t,i){var r={get:i,configurable:!1};Object.defineProperty(n,t,r)};$h.InitialData.prototype={$15_0:null,$b_0:null,$X_0:null,$w_0:null,$j_0:null,$0_0:null,get_$8_0:function(){var n=this.$0_0.permissionLevel;return $h.ScriptHelpers.isUndefined(n)?0:n},get_$35_0:function(){return this.$0_0.id},get_$34_0:function(){return this.$0_0.itemClass},get_$26_0:function(){return new Date(this.$0_0.dateTimeCreated)},get_$27_0:function(){return new Date(this.$0_0.dateTimeModified)},get_$28_0:function(){return new Date(this.$0_0.dateTimeSent)},get_$1p_0:function(){return this.$0_0.subject},get_$1k_0:function(){return this.$0_0.normalizedSubject},get_$33_0:function(){return this.$0_0.internetMessageId},get_$1z_0:function(){return this.$0_0.conversationId},get_$3F_0:function(){this.$E_0();var n=this.$0_0.sender;return $h.ScriptHelpers.isNullOrUndefined(n)?null:new $h.EmailAddressDetails(n)},get_$2I_0:function(){this.$E_0();var n=this.$0_0.from;return $h.ScriptHelpers.isNullOrUndefined(n)?null:new $h.EmailAddressDetails(n)},get_$14_0:function(){this.$E_0();null===this.$15_0&&(this.$15_0=this.$f_0("to"));return this.$15_0},get_$a_0:function(){this.$E_0();null===this.$b_0&&(this.$b_0=this.$f_0("cc"));return this.$b_0},get_$1v_0:function(){this.$E_0();null===this.$X_0&&(this.$X_0=this.$22_0());return this.$X_0},get_$2F_0:function(){return this.$0_0.ewsUrl},get_$1m_0:function(){return new Date(this.$0_0.start)},get_$1N_0:function(){return new Date(this.$0_0.end)},get_$1f_0:function(){return this.$0_0.location},get_$3C_0:function(){this.$E_0();null===this.$w_0&&(this.$w_0=this.$f_0("resources"));return this.$w_0},get_$37_0:function(){this.$E_0();var n=this.$0_0.organizer;return $h.ScriptHelpers.isNullOrUndefined(n)?null:new $h.EmailAddressDetails(n)},get_$3H_0:function(){return this.$0_0.userDisplayName},get_$3I_0:function(){return this.$0_0.userEmailAddress},get_$3J_0:function(){return this.$0_0.userTimeZone},get_$13_0:function(){return this.$0_0.timeZoneOffsets},get_$32_0:function(){return this.$0_0.hostVersion},get_$38_0:function(){return this.$0_0.owaView},$Q_0:function(){this.$j_0||(this.$j_0=new $h.Entities(this.$0_0.entities,this.$0_0.filteredEntities,this.get_$28_0(),this.get_$8_0()));return this.$j_0},$1U_0:function(n){var t=this.$Q_0();return t.$2Q_0(n)},$m_0:function(n){var t=this.$Q_0();return t.$m_0(n)},$p_0:function(){return this.$0_0.regExMatches?this.$0_0.regExMatches:null},$1Y_0:function(n){var t=this.$p_0();return!t||!t[n]?null:t[n]},$f_0:function(n){var i=this.$0_0[n];if($h.ScriptHelpers.isNullOrUndefined(i))return[];for(var r=[],t=0;t<i.length;t++)$h.ScriptHelpers.isNullOrUndefined(i[t])||(r[t]=new $h.EmailAddressDetails(i[t]));return r},$22_0:function(){var t=this.$0_0.attachments;if($h.ScriptHelpers.isNullOrUndefined(t))return[];for(var i=[],n=0;n<t.length;n++)$h.ScriptHelpers.isNullOrUndefined(t[n])||(i[n]=new $h.AttachmentDetails(t[n]));return i},$E_0:function(){OSF.DDA.OutlookAppOm.$D(this.get_$8_0())}};$h.LoadDictionaryRequest=function(n,t,i,r){$h.LoadDictionaryRequest.initializeBase(this,[r]);this.$1F_1=n;this.$1K_1=t;this.$I_1=i};$h.LoadDictionaryRequest.prototype={$1K_1:null,$1F_1:null,$I_1:null,handleResponse:function(n){if(n.wasSuccessful){var i=n[this.$1K_1];var t=JSON.parse(i);this.createAsyncResult(this.$1F_1(t),0,null)}else this.createAsyncResult(null,1,n.errorMessage);this.$I_1(this.$P_0)}};$h.ProxyRequestBase=function(n){$h.ProxyRequestBase.initializeBase(this,[n])};$h.ProxyRequestBase.prototype={handleResponse:function(n){if(n.wasProxySuccessful){this.set_$1n_1(n.statusCode);this.set_$1o_1(n.statusDescription);this.set_$x_1(n.body);this.createAsyncResult(this.get_$x_1(),0,null)}else{this.set_$1n_1(500);this.set_$1o_1("Error");var t=n.errorMessage;this.set_$x_1(t);this.createAsyncResult(null,1,t)}this.$39_1(n);this.$25_1()},$12_1:function(){throw Error.create("DOMException",{code:11,message:"INVALID_STATE_ERR"});},$25_1:function(){var n=this;this.$c_1(2,function(){n.$c_1(3,function(){n.$c_1(4,null)})})},$c_1:function(n,t){this.set_$1l_1(n);var i=this;window.setTimeout(function(){try{i.$1x_1()}finally{$h.ScriptHelpers.isNullOrUndefined(t)||t()}},0)},$1y_1:function(){this.get_$1l_1()!==1&&this.$12_1();this.$1e_0&&this.$12_1()}};$h.RequestBase=function(n){this.$1r_0=n};$h.RequestBase.prototype={$1e_0:!1,$P_0:null,$1r_0:null,$z_0:function(n,t,i){this.$1e_0=!0;var r=this;OSF.DDA.OutlookAppOm.$4.$7_0(n,t,i,function(n,t){n?r.createAsyncResult(null,1,String.format(_u.ExtensibilityStrings.l_InternalProtocolError_Text,n)):r.handleResponse(t)})},createAsyncResult:function(n,t,i){this.$P_0=OSF.DDA.OutlookAppOm.$9(n,t,i,this.$1r_0)}};$h.SaveDictionaryRequest=function(n,t){$h.SaveDictionaryRequest.initializeBase(this,[t]);$h.ScriptHelpers.isNullOrUndefined(n)||(this.$I_1=n)};$h.SaveDictionaryRequest.prototype={$I_1:null,handleResponse:function(n){n.wasSuccessful?this.createAsyncResult(null,0,null):this.createAsyncResult(null,1,n.errorMessage);$h.ScriptHelpers.isNullOrUndefined(this.$I_1)||this.$I_1(this.$P_0)}};$h.ScriptHelpers=function(){};$h.ScriptHelpers.isNull=function(n){return null===n};$h.ScriptHelpers.isNullOrUndefined=function(n){return $h.ScriptHelpers.isNull(n)||$h.ScriptHelpers.isUndefined(n)};$h.ScriptHelpers.isUndefined=function(n){return n===undefined};$h.ScriptHelpers.dictionaryContainsKey=function(n,t){return Object.isInstanceOfType(n)?t in n:!1};OSF.DDA.OutlookAppOm.registerClass("OSF.DDA.OutlookAppOm");OSF.DDA.Settings.registerClass("OSF.DDA.Settings");$h.Item.registerClass("$h.Item");$h.Appointment.registerClass("$h.Appointment",$h.Item);$h.AttachmentDetails.registerClass("$h.AttachmentDetails");$h.Contact.registerClass("$h.Contact");$h.CustomProperties.registerClass("$h.CustomProperties");$h.Diagnostics.registerClass("$h.Diagnostics");$h.EmailAddressDetails.registerClass("$h.EmailAddressDetails");$h.Entities.registerClass("$h.Entities");$h.Message.registerClass("$h.Message",$h.Item);$h.MeetingRequest.registerClass("$h.MeetingRequest",$h.Message);$h.MeetingSuggestion.registerClass("$h.MeetingSuggestion");$h.MeetingSuggestionTimeDecoder.registerClass("$h.MeetingSuggestionTimeDecoder");$h.ExtractedDate.registerClass("$h.ExtractedDate");$h.PreciseDate.registerClass("$h.PreciseDate",$h.ExtractedDate);$h.RelativeDate.registerClass("$h.RelativeDate",$h.ExtractedDate);$h.PhoneNumber.registerClass("$h.PhoneNumber");$h.TaskSuggestion.registerClass("$h.TaskSuggestion");$h.UserProfile.registerClass("$h.UserProfile");$h.RequestBase.registerClass("$h.RequestBase");$h.ProxyRequestBase.registerClass("$h.ProxyRequestBase",$h.RequestBase);$h.EwsRequest.registerClass("$h.EwsRequest",$h.ProxyRequestBase);$h.InitialData.registerClass("$h.InitialData");$h.LoadDictionaryRequest.registerClass("$h.LoadDictionaryRequest",$h.RequestBase);$h.SaveDictionaryRequest.registerClass("$h.SaveDictionaryRequest",$h.RequestBase);$h.ScriptHelpers.registerClass("$h.ScriptHelpers");OSF.DDA.OutlookAppOm.$1i=100;OSF.DDA.OutlookAppOm.$1j=255;OSF.DDA.OutlookAppOm.$S=32768;OSF.DDA.OutlookAppOm.$1h=255;OSF.DDA.OutlookAppOm.$1g=1e6;OSF.DDA.OutlookAppOm.$4=null;$h.AttachmentDetails.$Y=[Microsoft.Office.WebExtension.MailboxEnums.AttachmentType.File,Microsoft.Office.WebExtension.MailboxEnums.AttachmentType.Item];$h.Diagnostics.outlookAppName="Outlook";$h.Diagnostics.outlookWebAppName="OutlookWebApp";$h.EmailAddressDetails.$i="";$h.EmailAddressDetails.$y=[Microsoft.Office.WebExtension.MailboxEnums.ResponseType.None,Microsoft.Office.WebExtension.MailboxEnums.ResponseType.Organizer,Microsoft.Office.WebExtension.MailboxEnums.ResponseType.Tentative,Microsoft.Office.WebExtension.MailboxEnums.ResponseType.Accepted,Microsoft.Office.WebExtension.MailboxEnums.ResponseType.Declined];$h.EmailAddressDetails.$v=[Microsoft.Office.WebExtension.MailboxEnums.RecipientType.Other,Microsoft.Office.WebExtension.MailboxEnums.RecipientType.DistributionList,Microsoft.Office.WebExtension.MailboxEnums.RecipientType.User,Microsoft.Office.WebExtension.MailboxEnums.RecipientType.ExternalUser];$h.Entities.$V=["Addresses","EmailAddresses","Urls","PhoneNumbers","TaskSuggestions","MeetingSuggestions","Contacts"];$h.MeetingSuggestionTimeDecoder.$1A=new Date("0001-01-01T00:00:00Z");$h.ScriptHelpers.emptyString=""

/* Office rich client common JavaScript API library */
/* Version: 15.0.4469.1000 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

OSF.ClientMode={ReadWrite:0,ReadOnly:1};OSF.DDA.RichInitializationReason={1:Microsoft.Office.WebExtension.InitializationReason.Inserted,2:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened};Microsoft.Office.WebExtension.FileType={Text:"text",Compressed:"compressed"};OSF.DDA.RichClientSettingsManager={read:function(e,d){var b=[],f=[];e&&e();window.external.GetContext().GetSettings().Read(b,f);d&&d();for(var c={},a=0;a<b.length;a++)c[b[a]]=f[a];return c},write:function(a,g,c,b){var e=[],d=[];for(var f in a){e.push(f);d.push(a[f])}c&&c();window.external.GetContext().GetSettings().Write(e,d);b&&b()}};OSF.DDA.DispIdHost.getRichClientDelegateMethods=function(e){var a={};a[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=OSF.DDA.SafeArray.Delegate.executeAsync;a[OSF.DDA.DispIdHost.Delegates.RegisterEventAsync]=OSF.DDA.SafeArray.Delegate.registerEventAsync;a[OSF.DDA.DispIdHost.Delegates.UnregisterEventAsync]=OSF.DDA.SafeArray.Delegate.unregisterEventAsync;function b(a){return function(b){var d,c;try{c=a(b.hostCallArgs,b.onCalling,b.onReceiving);d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}catch(e){d=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;c={name:Strings.OfficeOM.L_InternalError,message:e}}b.onComplete&&b.onComplete(d,c)}}function d(c,b,a){return OSF.DDA.RichClientSettingsManager.read(b,a)}function c(a,c,b){return OSF.DDA.RichClientSettingsManager.write(a[OSF.DDA.SettingsManager.SerializedSettings],a[Microsoft.Office.WebExtension.Parameters.OverwriteIfStale],c,b)}switch(e){case OSF.DDA.AsyncMethodNames.RefreshAsync.id:a[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=b(d);break;case OSF.DDA.AsyncMethodNames.SaveAsync.id:a[OSF.DDA.DispIdHost.Delegates.ExecuteAsync]=b(c)}return a};OSF.DDA.File=function(e,c,b){OSF.OUtil.defineEnumerableProperties(this,{size:{value:c},sliceCount:{value:Math.ceil(c/b)}});var a={};a[OSF.DDA.FileProperties.Handle]=e;a[OSF.DDA.FileProperties.SliceSize]=b;var d=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[d.GetDocumentCopyChunkAsync,d.ReleaseDocumentCopyAsync],a)};OSF.DDA.FileSliceOffset="fileSliceoffset";OSF.DDA.CustomXmlParts=function(){this._eventDispatches=[];var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.AddDataPartAsync,a.GetDataPartByIdAsync,a.GetDataPartsByNameSpaceAsync])};OSF.DDA.CustomXmlPart=function(f,b,g){OSF.OUtil.defineEnumerableProperties(this,{builtIn:{value:g},id:{value:b},namespaceManager:{value:new OSF.DDA.CustomXmlPrefixMappings(b)}});var c=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[c.DeleteDataPartAsync,c.GetPartNodesAsync,c.GetPartXmlAsync]);var e=f._eventDispatches,a=e[b];if(!a){var d=Microsoft.Office.WebExtension.EventType;a=new OSF.EventDispatch([d.DataNodeDeleted,d.DataNodeInserted,d.DataNodeReplaced]);e[b]=a}OSF.DDA.DispIdHost.addEventSupport(this,a)};OSF.DDA.CustomXmlPrefixMappings=function(b){var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.AddDataPartNamespaceAsync,a.GetDataPartNamespaceAsync,a.GetDataPartPrefixAsync],b)};OSF.DDA.CustomXmlNode=function(d,c,e,b){OSF.OUtil.defineEnumerableProperties(this,{baseName:{value:b},namespaceUri:{value:e},nodeType:{value:c}});var a=OSF.DDA.AsyncMethodNames;OSF.DDA.DispIdHost.addAsyncMethods(this,[a.GetRelativeNodesAsync,a.GetNodeValueAsync,a.GetNodeXmlAsync,a.SetNodeValueAsync,a.SetNodeXmlAsync],d)};OSF.DDA.NodeInsertedEventArgs=function(b,a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DataNodeInserted},newNode:{value:b},inUndoRedo:{value:a}})};OSF.DDA.NodeReplacedEventArgs=function(c,b,a){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DataNodeReplaced},oldNode:{value:c},newNode:{value:b},inUndoRedo:{value:a}})};OSF.DDA.NodeDeletedEventArgs=function(c,a,b){OSF.OUtil.defineEnumerableProperties(this,{type:{value:Microsoft.Office.WebExtension.EventType.DataNodeDeleted},oldNode:{value:c},oldNextSibling:{value:a},inUndoRedo:{value:b}})}